<form [formGroup]="studentForm" (ngSubmit)="submitForm()">
  <mat-form-field appearance="outline">
    <mat-label>Name</mat-label>
    <input matInput formControlName="name" required>
    <mat-error *ngIf="studentForm.get('name')?.hasError('required')">
      Name is required
    </mat-error>
  </mat-form-field>

  <mat-radio-group formControlName="gender" required>
    <mat-label>Gender: </mat-label>
    <mat-radio-button value="Male">Male</mat-radio-button>
    <mat-radio-button value="Female">Female</mat-radio-button>
  </mat-radio-group>

  <mat-form-field appearance="outline">
    <mat-label>Course</mat-label>
    <mat-select formControlName="course" required>
      @for (course of courses; track $index) {
        <mat-option [value]="course">{{ course }}</mat-option>
      }
    </mat-select>
    <mat-error *ngIf="studentForm.get('course')?.hasError('required')">
      Course is required
    </mat-error>
  </mat-form-field>

  <div class="hobbies-container">
    <mat-label>Hobbies:</mat-label>
    @for (hobby of hobbies; track $index) {
      <mat-checkbox
        [checked]="(studentForm.get('hobbies')?.value || []).includes(hobby)"
        (change)="hobbyCheckboxSelection($event.checked, hobby)">
        {{ hobby }}
      </mat-checkbox>
    }
  </div>

  <mat-form-field appearance="outline">
    <mat-label>City</mat-label>
    <input matInput formControlName="city" [matAutocomplete]="auto" required>
    <mat-autocomplete #auto="matAutocomplete" (optionSelected)="onCitySelected($event)">
      @for (option of filteredOptions | async; track $index) {
        <mat-option [value]="option">{{ option }}</mat-option>
      }
    </mat-autocomplete>
    <mat-error *ngIf="studentForm.get('city')?.hasError('required')">
      City is required
    </mat-error>
  </mat-form-field>

  <button mat-raised-button color="primary" type="submit" [disabled]="studentForm.invalid">
    {{ editingIndex >= 0 ? 'Update' : 'Submit' }}
  </button>
</form>
