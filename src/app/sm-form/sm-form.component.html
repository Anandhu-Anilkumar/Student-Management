<form [formGroup]="studentForm" (ngSubmit)="submitForm()">
  <mat-form-field appearance="fill">
    <mat-label>Name</mat-label>
    <input matInput formControlName="name" />
  </mat-form-field>

  <mat-radio-group formControlName="gender">
    <mat-radio-button value="Male">Male</mat-radio-button>
    <mat-radio-button value="Female">Female</mat-radio-button>
  </mat-radio-group>

  <mat-form-field appearance="fill">
    <mat-label>Course</mat-label>
    <mat-select formControlName="course">
      @for (course of courses; track $index) {
        <mat-option [value]="course">{{ course }}</mat-option>
      }
    </mat-select>
  </mat-form-field>

  <div>
    <label>Hobbies:</label>
    @for (hobby of hobbies; track $index) {
      <div>
        <mat-checkbox [checked]="studentForm.value.hobbies?.includes(hobby)" (change)="hobbyCheckboxSelection($event.checked, hobby)">
          {{ hobby }}
        </mat-checkbox>
      </div>
    }
  </div>

  <mat-form-field appearance="fill">
    <mat-label>City</mat-label>
    <input matInput formControlName="city" [matAutocomplete]="auto" autocomplete="off" />
    <mat-autocomplete #auto="matAutocomplete">
      @for (option of filteredOptions; track $index) {
        <mat-option [value]="option">{{ option }}</mat-option>
      }
    </mat-autocomplete>
  </mat-form-field>

  <div>editingIndex: {{editingIndex}}</div>
  <button mat-raised-button color="primary" [disabled]="studentForm.invalid">{{ editingIndex >= 0 ? 'Update' : 'Submit' }}</button>
</form>

<mat-table [dataSource]="students" class="mat-elevation-z8">
  <ng-container matColumnDef="name">
    <mat-header-cell *matHeaderCellDef>Name</mat-header-cell>
    <mat-cell *matCellDef="let student">{{ student.name }}</mat-cell>
  </ng-container>

  <ng-container matColumnDef="gender">
    <mat-header-cell *matHeaderCellDef>Gender</mat-header-cell>
    <mat-cell *matCellDef="let student">{{ student.gender }}</mat-cell>
  </ng-container>

  <ng-container matColumnDef="course">
    <mat-header-cell *matHeaderCellDef>Course</mat-header-cell>
    <mat-cell *matCellDef="let student">{{ student.course }}</mat-cell>
  </ng-container>

  <ng-container matColumnDef="hobbies">
    <mat-header-cell *matHeaderCellDef>Hobbies</mat-header-cell>
    <mat-cell *matCellDef="let student">{{ student.hobbies.join(', ') }}</mat-cell>
  </ng-container>

  <ng-container matColumnDef="city">
    <mat-header-cell *matHeaderCellDef>City</mat-header-cell>
    <mat-cell *matCellDef="let student">{{ student.city }}</mat-cell>
  </ng-container>

  <ng-container matColumnDef="actions">
    <mat-header-cell *matHeaderCellDef>Actions</mat-header-cell>
    <mat-cell *matCellDef="let student; let i = index">
      <button mat-icon-button (click)="editStudent(i)">
        <mat-icon>edit</mat-icon>
      </button>
      <button mat-icon-button (click)="deleteStudent(i)">
        <mat-icon>delete</mat-icon>
      </button>
    </mat-cell>
  </ng-container>

  <mat-header-row *matHeaderRowDef="['name', 'gender', 'course', 'hobbies', 'city', 'actions']"></mat-header-row>
  <mat-row *matRowDef="let row; columns: ['name', 'gender', 'course', 'hobbies', 'city', 'actions']"></mat-row>
</mat-table>
